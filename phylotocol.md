# FADS and ELOVL Phylogeny Phylotocol
 
 Principal Investigators: Abby Uehling, Gustav Paulay, Joseph Ryan  

 Version Number: v.0.01

 Date: 13 Dec 2024  

## SUMMARY OF CHANGES FROM PREVIOUS VERSION

v.0.01 created

## 1 INTRODUCTION: BACKGROUND INFORMATION AND SCIENTIFIC RATIONALE  

### 1.1 _Background Information and Rationale_  

We conducted target-capture sequencing and generated a dataset of 361 sea cucumbers spanning the tree. 

We are conducting a phylogenetic analysis to build a tree of sea cucumber life.

We used phyluce pipeline to generate a nucleotide alignment. 

We used the script `make_orf_only_matrices.pl` to generate a cds alignment of nucleotide coding sequences only and the corresponding amino acid alignment.

We downloaded protein models of non-sea cucumbers from Echinobase, and then used a modified version of hmm2aln.pl hmm2aln_topdomain_only.pl to run an hmmsearch for each partition and use these hits to add these outgroups to the amino acid matrix.


## 2 STUDY DESIGN AND ENDPOINTS  

1. We have run a nucleotide tree on the entire matrix generated by phyluce using iqtree (using ModelFinder to choose the best model).

2. We will use modelomatic (doi:10.1093/sysbio/syu062) option in iqtree to decide between RY, nucleotide, codon substitution, and amino acid models on cds/aa dataset.

3. If it works and the NT model is found to be the best model, we will use average clade support (10.1038/nature12130) to pick the best tree between these two.

4. If it works and the RY or codon model is found to be best, we will report that tree as the best tree.

5. If it works and the AA model is found to be best, we will run an additional amino-acid tree with the C60 profile mixture model and use average clade support to pick the best tree between these two.

6. If it doesn't work (and we have reason to think it won't) we will do the following:

7. Using the aa and cds matrices, run an NT, Codon, and amino-acid tree with the C60 profile mixture model and use average clade support to choose the best tree between these and our NT tree that uses all the data.

8. We will use average clade support to choose between the nt tree on entire matrix, NT on cds matrix, Codon model on cds matrix, and C60 tree on aa matrix.

9. We will also run a C60 tree on aa matrix with the outgroups that were added. If the sea cucumber topology is identical between the C60 tree with outgroups and the tree with the best average clade support (without outgroups),  we will report the tree with outgroups as the main tree. If the topology is different, we will report the tree without outgroups and root it in the same way as the tree with outgroups.

#### 2.1 DATASETS AND SOFTWARE

* 361 seq cucumber taxa including
* phyluce
* iqtree

#### 2.2 COMMANDS

* We will add these as we are running the study design for the first time.

## 3 WORK COMPLETED SO FAR WITH DATES  

13 Dec 2024 - We have run phyluce, run a preliminary tree on the resulting nucleotide matrix, generated a CDS and AA alignment, created a version of the AA alignment with outgroups.

## APPENDIX

Version&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;Date&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Significant Revisions    
0.0.2  
0.0.3  
0.0.4  
